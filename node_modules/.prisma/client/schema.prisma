generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id                       String               @id @default(uuid())
  displayName              String
  role                     String[]
  email                    String               @unique
  salt                     String
  phone                    String
  hashPassword             String
  courseEnrollments        courseEnrollments[]
  courses_instructor       courses[]
  facultyProfile           faculty?
  institutions_admin       institutions[]       @relation("InstitutionAdmin")
  internships_industryUser internships[]
  mentors                  mentors?
  profiles                 profile?
  user_notifications       user_notifications[]
}

model institutions {
  id            String    @id @default(uuid())
  instituteName String
  state         String
  adminUserId   String
  createdAt     DateTime
  faculty       faculty[]
  adminUser     users     @relation("InstitutionAdmin", fields: [adminUserId], references: [id])
  profiles      profile[]
}

model profile {
  id                     String                    @id @default(uuid())
  userId                 String                    @unique
  bio                    String?
  gender                 String?
  DOB                    DateTime?
  avatarURL              String?
  github                 String?
  linkedin               String?
  skills                 String[]
  interests              String[]
  department             String?
  resourceId             String?
  instituteId            String
  facultyId              String?
  certificates           certificates[]
  credits                credits[]
  internshipApplications internship_applications[]
  mentorReviews          mentorReviews[]
  mentorSessions         mentorSessions[]
  portfolioProjects      portfolioProjects[]
  faculty                faculty?                  @relation(fields: [facultyId], references: [id])
  institution            institutions              @relation(fields: [instituteId], references: [id])
  user                   users                     @relation(fields: [userId], references: [id])
  learningProgress       studentLearningProgress[]
}

model roadmaps {
  id          String        @id @default(uuid())
  title       String
  description String
  domain      String
  checkpoints checkpoints[]
}

model checkpoints {
  id           String                    @id @default(uuid())
  roadmapId    String
  title        String
  description  String
  resourceType String
  resourceUrl  String
  roadmap      roadmaps                  @relation(fields: [roadmapId], references: [id])
  progress     studentLearningProgress[]
}

model studentLearningProgress {
  id           String      @id @default(uuid())
  profileId    String
  checkpointId String
  isCompleted  Boolean
  completedAt  DateTime?
  checkpoint   checkpoints @relation(fields: [checkpointId], references: [id])
  profile      profile     @relation(fields: [profileId], references: [id])
}

model courses {
  id            String              @id @default(uuid())
  title         String
  description   String
  type          CourseType
  price         Float?
  instructorId  String
  thumbnail_url String?
  created_at    DateTime
  enrollments   courseEnrollments[]
  instructor    users               @relation(fields: [instructorId], references: [id])
}

model courseEnrollments {
  id              String   @id @default(uuid())
  courseId        String
  userId          String
  progressPercent Float?
  enrolledAt      DateTime
  course          courses  @relation(fields: [courseId], references: [id])
  user            users    @relation(fields: [userId], references: [id])
}

model mentors {
  id        String           @id @default(uuid())
  user_id   String           @unique
  expertise Json?
  rating    Float?
  bio       String?
  reviews   mentorReviews[]
  sessions  mentorSessions[]
  user      users            @relation(fields: [user_id], references: [id])
}

model mentorSessions {
  id           String              @id @default(uuid())
  studentId    String
  mentorId     String
  scheduled_at DateTime
  status       MentorSessionStatus
  meeting_link String?
  mentor       mentors             @relation(fields: [mentorId], references: [id])
  student      profile             @relation(fields: [studentId], references: [id])
}

model mentorReviews {
  id        String  @id @default(uuid())
  mentorId  String
  rating    Float
  reviews   String?
  studentId String
  mentor    mentors @relation(fields: [mentorId], references: [id])
  student   profile @relation(fields: [studentId], references: [id])
}

model portfolioProjects {
  id          String   @id @default(uuid())
  user_id     String
  title       String
  description String?
  github_url  String?
  live_url    String?
  tags        String[]
  user        profile  @relation(fields: [user_id], references: [id])
}

model internships {
  id               String                    @id @default(uuid())
  industry_user_id String
  title            String
  description      String
  type             String
  stipend          Float?
  location         String
  required_skills  Json
  duration_weeks   Int
  created_at       DateTime
  applications     internship_applications[]
  industryUser     users                     @relation(fields: [industry_user_id], references: [id])
}

model internship_applications {
  id             String                  @id @default(uuid())
  internship_id  String
  student_id     String
  status         InternshipStatus
  submission_url String?
  score          Float?
  applied_at     DateTime
  internship     internships             @relation(fields: [internship_id], references: [id])
  student        profile                 @relation(fields: [student_id], references: [id])
  evaluations    internship_evaluation[]
  logbookEntries logbook_entries[]
}

model logbook_entries {
  id            String                  @id @default(uuid())
  applicationId String
  date          DateTime
  taskDone      String
  proofUrl      String?
  hours_spent   Int
  application   internship_applications @relation(fields: [applicationId], references: [id])
}

model internship_evaluation {
  id             String                  @id @default(uuid())
  application_id String
  faculty_id     String
  rubric_json    Json?
  comments       String?
  final_score    Float?
  application    internship_applications @relation(fields: [application_id], references: [id])
  faculty        faculty                 @relation(fields: [faculty_id], references: [id])
}

model faculty {
  id          String                  @id @default(uuid())
  instituteId String
  userId      String                  @unique
  name        String
  department  String
  institution institutions            @relation(fields: [instituteId], references: [id])
  user        users                   @relation(fields: [userId], references: [id])
  evaluations internship_evaluation[]
  students    profile[]
}

model credits {
  id             String  @id @default(uuid())
  student_id     String
  credits_earned Float
  student        profile @relation(fields: [student_id], references: [id])
}

model certificates {
  id             String   @id @default(uuid())
  student_id     String
  title          String
  certificateUrl String
  issuedAt       DateTime
  student        profile  @relation(fields: [student_id], references: [id])
}

model notifications {
  id                String               @id @default(uuid())
  title             String
  message           String
  created_at        DateTime
  userNotifications user_notifications[]
}

model user_notifications {
  id              String        @id @default(uuid())
  user_id         String
  notification_id String
  isRead          Boolean
  read_at         DateTime?
  notification    notifications @relation(fields: [notification_id], references: [id])
  user            users         @relation(fields: [user_id], references: [id])
}

enum CourseType {
  PAID
  FREE
  GOVT
}

enum MentorSessionStatus {
  PENDING
  COMPLETED
  CANCELLED
}

enum InternshipStatus {
  APPLIED
  SHORTLISTED
  SELECTED
  REJECTED
}
